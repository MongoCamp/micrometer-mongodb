import{_ as a,o as e,c as o,a as n}from"./app.72efe976.js";const d=JSON.parse('{"title":"Micrometer Registry","description":"","frontmatter":{},"headers":[{"level":2,"title":"Registry with config","slug":"registry-with-config","link":"#registry-with-config","children":[]},{"level":2,"title":"Registry with DAO","slug":"registry-with-dao","link":"#registry-with-dao","children":[]},{"level":2,"title":"Registry with overridden config","slug":"registry-with-overridden-config","link":"#registry-with-overridden-config","children":[]}],"relativePath":"documentation/registry.md","lastUpdated":1743325747000}'),t={name:"documentation/registry.md"};function l(r,s,p,i,c,y){return e(),o("div",null,s[0]||(s[0]=[n(`<h1 id="micrometer-registry" tabindex="-1">Micrometer Registry <a class="header-anchor" href="#micrometer-registry" aria-hidden="true">#</a></h1><p>Micrometer MongoDb is based on <a href="https://mongodb-driver.mongocamp.dev/" target="_blank" rel="noreferrer">MongoCamp MongoDb Driver</a> so the <a href="https://mongodb-driver.mongocamp.dev/documentation/database/config.html" target="_blank" rel="noreferrer">configuration</a> for connections without given DAO are loaded like MongoCamp Driver is loading <a href="https://mongodb-driver.mongocamp.dev/documentation/database/config.html" target="_blank" rel="noreferrer">default connection</a>.</p><p>Configurations for Micrometer MongoDb registry is loaded from application.conf (or reference.conf) path <code>dev.mongocamp.micrometer.mongodb</code>. For save max duration the setting <code>save</code> is used.</p><h2 id="registry-with-config" tabindex="-1">Registry with config <a class="header-anchor" href="#registry-with-config" aria-hidden="true">#</a></h2><div class="language-scala"><button title="Copy Code" class="copy"></button><span class="lang">scala</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#89DDFF;">val</span><span style="color:#BABED8;"> collectionName </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">test_registry_collection_with_wait</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#89DDFF;">val</span><span style="color:#BABED8;"> registry       </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> </span><span style="color:#FFCB6B;">MongoStepMeterRegistry</span><span style="color:#BABED8;">(collectionName, </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">unit.test.mongo</span><span style="color:#89DDFF;">&quot;</span><span style="color:#BABED8;">)</span></span></code></pre></div><h2 id="registry-with-dao" tabindex="-1">Registry with DAO <a class="header-anchor" href="#registry-with-dao" aria-hidden="true">#</a></h2><div class="language-scala"><button title="Copy Code" class="copy"></button><span class="lang">scala</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#89DDFF;">val</span><span style="color:#BABED8;"> collectionName </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">test_registry_collection_with_wait_from_dao</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#89DDFF;">val</span><span style="color:#BABED8;"> dao            </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> </span><span style="color:#FFCB6B;">MongoTestServer</span><span style="color:#BABED8;">.provider.dao(collectionName)</span></span>
<span class="line"><span style="color:#89DDFF;">val</span><span style="color:#BABED8;"> registry       </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> </span><span style="color:#FFCB6B;">MongoStepMeterRegistry</span><span style="color:#BABED8;">(dao)</span></span></code></pre></div><h2 id="registry-with-overridden-config" tabindex="-1">Registry with overridden config <a class="header-anchor" href="#registry-with-overridden-config" aria-hidden="true">#</a></h2><p>Every apply-methode for <code>MongoStepMeterRegistry</code> has the possibility to override the settings from application.conf with an Map[String, String], for example if you have multiple registries in running application with different settings.</p><div class="language-scala"><button title="Copy Code" class="copy"></button><span class="lang">scala</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#89DDFF;">val</span><span style="color:#BABED8;"> collectionName   </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">test_registry_collection_with_wait_from_dao_15</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#89DDFF;">val</span><span style="color:#BABED8;"> configurationMap </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> </span><span style="color:#FFCB6B;">Map</span><span style="color:#BABED8;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">step</span><span style="color:#89DDFF;">&quot;</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">-&gt;</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">15s</span><span style="color:#89DDFF;">&quot;</span><span style="color:#BABED8;">, </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">save</span><span style="color:#89DDFF;">&quot;</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">-&gt;</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">2m</span><span style="color:#89DDFF;">&quot;</span><span style="color:#BABED8;">)</span></span>
<span class="line"><span style="color:#89DDFF;">val</span><span style="color:#BABED8;"> registry         </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> </span><span style="color:#FFCB6B;">MongoStepMeterRegistry</span><span style="color:#BABED8;">(collectionName, configurationMap)</span></span></code></pre></div><p>The reference.conf default values are:</p><div class="language-json"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#BABED8;">dev.mongocamp.micrometer.mongodb </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#BABED8;">    step = 5m</span></span>
<span class="line"><span style="color:#BABED8;">    save = 15s</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre></div>`,12)]))}const g=a(t,[["render",l]]);export{d as __pageData,g as default};
